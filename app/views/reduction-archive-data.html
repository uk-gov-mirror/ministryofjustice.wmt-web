{% extends "includes/layout.html" %} 

{% block content %}

<main id="content" role="main">

{% include "includes/breadcrumbs.html" %}
 
{% include "includes/title-subtitle.html" %}

{% include "includes/validation-error-messages.html" %}

<form method="post" class "archive-form">
        {% include "includes/csrf-hidden-input.html"%}
        <input id="rawQuery" type="hidden" name="rawQuery" value="{{ stringifiedBody }}">
        <input id="startSearching" type="hidden" name="startSearching" value="{{ startSearching }}">

         <div class="form-group {% if errors[archiveFromDate][0] %} form-group-error {% endif %}" id="from">
            {% if errors %}
                <span class="error-message">{{ errors[archiveFromDate][0] }}</span>
            {% endif %}
            <fieldset id="archiveFromDate">
                <legend>
                    <span class="form-label-bold">
                        Show archive data from:
                    </span>
                    <span class="form-hint" id="reduction-archive-from-hint">For example, 30 1 2015 - This date must be on or after 24/10/2014</span>
                </legend>
                <div class="form-date" aria-describedby="reduction-archive-from-hint">
                    <div class="form-group form-group-day">
                        <label class="form-label" for="reduction-archive-from-day">Day</label>
                        <input class="form-control" id="reduction-archive-from-day" name="reduction-archive-from-day" 
                            value={{dateRange.fromFields[0] | int}}>
                     </div>
                    <div class="form-group form-group-month">
                        <label class="form-label" for="reduction-archive-from-month">Month</label>
                        <input class="form-control" id="reduction-archive-from-month" name="reduction-archive-from-month" 
                            value={{dateRange.fromFields[1] | int}}>
                    </div>
                    <div class="form-group form-group-year">
                        <label class="form-label" for="reduction-archive-from-year">Year</label>
                        <input class="form-control" id="reduction-archive-from-year" name="reduction-archive-from-year" 
                        value={{dateRange.fromFields[2] | int}}>           
                    </div>
                </div>
            </fieldset>
        </div>
        <div class="form-group {% if errors[archiveToDate][0] %} form-group-error {% endif %}" id="to">
            {% if errors %}
                 <span class="error-message">{{ errors[archiveToDate][0] }}</span> 
            {% endif %}
            <fieldset id="archiveToDate">
                <legend>
                    <span class="form-label-bold">
                        Show archive data to:
                    </span>
                    <span class="form-hint" id="reduction-archive-to-hint">For example, 31 3 2015 - This date must be on or after 25/10/2014</span>
                </legend>
                <div class="form-date" aria-describedby="reduction-archive-to-hint">
                    <div class="form-group form-group-day">
                        <label class="form-label" for="reduction-archive-to-day">Day</label>
                        <input class="form-control" id="reduction-archive-to-day" name="reduction-archive-to-day" 
                            value={{dateRange.toFields[0] | int}}>
                    </div>
                    <div class="form-group form-group-month">
                        <label class="form-label" for="reduction-archive-to-month">Month</label>
                        <input class="form-control" id="reduction-archive-to-month" name="reduction-archive-to-month"
                            value={{dateRange.toFields[1] | int}}>
                    </div>
                    <div class="form-group form-group-year">
                        <label class="form-label" for="reduction-archive-to-year">Year</label>
                        <input class="form-control" id="reduction-archive-to-year" name="reduction-archive-to-year"
                            value={{dateRange.toFields[2] | int}}>
                    </div>
                </div>
            </fieldset>
        </div>

        <div class="form-group" id="reductions-multi-search-field">
            <fieldset id="multiSearchDate">
                <legend>
                    <span class="form-label-bold">
                        Search by Offender Manager or Reduction Updater
                    </span>
                    <span class="form-hint" id="reductions-multi-search-field-hint">For Example, John Smith</span>
                </legend>
                <div aria-describedby="reductions-multi-search-field-hint">
                    <div class="form-group">
                        <label class="form-label" for="reductions-multi-search-field-entry">Extra Search Criteria</label>
                        <input class="form-control" id="reductions-multi-search-field-entry" name="reductions-multi-search-field-entry" value="{{ extraSearchCriteria | safe }}">
                        </div>
                </div>
            </fieldset>
        </div>

        <input id="archive-reductions-filter-submit" type="submit" value="Search" class="button" formaction="/archive-data/reductions-search">
        <input id="archive-reductions-csv-submit" type="submit" class="button sln-export" style="float: right; margin-left:10px; margin-bottom: 10px" value="Export Archived Reductions" formaction="/archive-data/reductions/archive-csv">
</form>
<br/>
<table id="reduction-archive-table" class="js-data-table data-table dataTable" cellspacing="0" width="100%" role="grid" style="width: 100%;" hidden>
    <thead>
        <tr class="headers">
            <th></th>
            <th id="offenderManager">Offender Manager</th>
            <th id="reductions">Reduction Hours</th>
            <th id="reductionReason">Reduction Reason</th>
            <th id="comments">Comments</th>
            <th id="reductionStartDate">Start Date</th>
            <th id="reductionExpiryDate">Expiry Date</th>
            <th id="reductionDate">Date Reduction Updated</th>
            <th id="reductionAddedBy">Reduction Updated By</th>
        </tr>
    </thead>
</table>
</main>

<script src="{{ asset_path }}javascripts/vendor/jquery.min.js"></script>
<script src="{{ asset_path }}javascripts/moment.min.js"></script>
<script src="{{ asset_path }}javascripts/datatables2.min.js"></script>
<script src="{{ asset_path }}javascripts/archive-reductions-new.js"></script>

{% endblock %}